#!/bin/bash -e

source allunix

trap 'exit $?' SIGHUP SIGINT SIGTERM

( mount | grep "on /Volumes/RAID_EXT" >/dev/null) || echo "RAID_EXT is missing. Exiting." exit 1

command -v gmvault >/dev/null 2>&1 ||  ( echo ""; echo "${RED}gmvault is missing, exiitng.${NORMAL}"; echo ""; exit 1 )

gmACCOUNTS=(
    jpartain89
    subFFbb89
    subkinkyboi89
)

function SYNCING() {
    ( for i in "${gmACCOUNTS[@]}"; do
        /usr/local/bin/gmvault sync "${i}@gmail.com" -d "/Volumes/RAID_EXT/backup/gmvault/${i}/" -t "$SYNC_TYPE"-e -m &  echo ""
        spinner $!
        printf "done!\n";
    done && exit 0 ) || echo "Received an error. Exiting... " exit 1;
}

if [ $# -lt 1 ]; then set full ; fi

while [ $# -ge 1 ]; do
    case "$1" in
        full )
            SYNC_TYPE=full; SYNCING
        ;;
        quick )
            SYNC_TYPE=quick; SYNCING
        ;;
    esac
done
