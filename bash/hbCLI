#!/bin/bash -e

while IFS= read -r VIDEO; do
  filename="$(basename ${VIDEO})"
  extension=${filename##*.}
  filename=${filename%.*}

  [ ! "${filename}.mp4" ] && 
  read -rp "Processing ${VIDEO}. Proceed? " yn
  case $yn in
    [Yy]* ) break;;
    [Nn]* ) exit;;
    * ) echo "Please answer yes or no.";;
  esac
  HandBrakeCLI -Z "Super HQ 1080p30 Surround" -i "${VIDEO}" -o "${filename}.mp4"
  echo ""
done < <(find /Volumes/BigPartition/Movies -iname "*.mkv"
