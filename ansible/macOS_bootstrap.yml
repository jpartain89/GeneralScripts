# My Attempt at an Ansible-Playbook macOS  bootstrapper
# This assumes that homebrew is already installed, as ansible and pip are
# installed through brew

- hosts: localhost

  vars:
    - jp_git: https://jpartain89@github.com/jpartain89
    - git_loc: /Users/jpartain89/git

  tasks:
    - name: Install brewfile
      homebrew:
        name: rcmdnk/file/brew-file
        state: latest
        update_homebrew: yes
        upgrade_all: yes

    - name: Clone standard github repos
      git:
        repo: "{{ item.repo }}"
        dest: "{{ item.dest }}"
        update: yes
      with_items:
        -
          repo: "{{ jp_git }}/conffiles.git"
          dest: "{{ git_loc }}/conffiles"
        -
          repo: "{{ jp_git }}/generalscripts.git"
          dest: "{{ git_loc }}/generalscripts"
        -
          repo: https://github.com/icefox/git-map.git
          dest: "{{ git_loc }}/git-map"
        -
          repo: "{{ jp_git }}/macos_dotfiles.git"
          dest: "{{ git_loc }}/macos_dotfiles"
        -
          repo: "{{ jp_git }}/myfunctions.git"
          dest: "{{ git_loc }}/myfunctions"

    - name: Run bootstrap.sh from macos_dotfiles
      shell: 'source "{{ git_loc }}/macos_dotfiles/bootstrap.sh"'
